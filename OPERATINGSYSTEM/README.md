# 운영체제
## 운영체제란
모든 프로그램은 실행을 위해 **자원**(resource)을 필요로 한다. 여기에 컴퓨터의 네 가지 핵심 부품이 포함된다. **운영체제**는 이러한 필요 자원을 할당하고 프로그램이 올바르게 실행되도록 돕는 특별한 프로그램이다.  

프로그램은 메모리에 적재되어 실행된다. 운영체제는 프로그램 중 가장 핵심적이기 때문에 다른 응용 프로그램과 달리 메모리 내 **커널 영역**이라는 곳에 적재된다. 다른 응용 프로그램은 **사용자 영역**이라는 곳에 적재된다.  

우리는 인터넷 브라우저를 실행할 때 메모리의 xx번지를 실행하라는 식으로 지시를 내리지 않았다. 그 역할을 운영체제가 해주고 있었다. 이게 운영체제의 **메모리 관리** 기능이다.

또, 우리는 인터넷만 하지 않는다. 음악도 듣고, 메모장도 사용할 수 있다. CPU가 이 많은 것들을 동시에 처리한다고 보이지만, 사실 눈치 못챌만큼 빠르게 번갈아가면서 실행시키고 있다고 볼 수 있다. 이 여러 프로그램 중 우선순위를 부여하거나 CPU 할당을 다르게 하는 것도 운영체제가 하는 **CPU 관리** 기능이다.  

워드와 메모장, 두 곳에서 프린터 출력을 하고 싶을 때 순서를 정하는 것도 운영체제의 **입출력장치 관리** 기능이다.  

즉, 운영체제는 하드웨어와 응용 프로그램 사이에 위치해서 자원을 효율적으로 분배하는 관리자 역할을 한다. 이는 국민을 위해 나라의 자원을 효율적으로 관리/분배해주는 정부의 역할과 유사하다.

## 운영체제를 왜 알아야하는가?
운영체제는 사용자를 위한 프로그램이 아닌, 프로그램을 위한 프로그램이다. 그렇기에 프로그램을 만드는 개발자는 운영체제를 알아야한다. 오류 메세지의 주체는 운영체제인 경우가 많아, 운영체제에 대한 이해는 오류 메세지에 대한 이해가 되고 문제 해결 능력의 향상을 가져온다.

## 운영체제의 큰 그림
#### 커널
운영체제는 현존하는 프로그램 중 규모가 가장 큰 프로그램 중 하나다. Windows, MacOS, Linux 등과 같이 다양한 운영체제가 있고, 따라서 운영체제가 제공하는 기능도 다양하다. 하지만, 그 중 공통적이고 핵심적인 기능은 존재한다. 자원에 접근하고 조작하는 기능, 프로그램이 올바르게 실행되도록 하는 기능이 그것인데, 이걸 담당하는 부분을 **커널**이라고 한다.  

> 운영체제에는 속하는데 커널에는 속하지 않는 기능이 있나?   

대표적으로, 유저 인터페이스(UI)가 있다.

#### 이중모드와 시스템 콜(호출)
일반적으로 응용 프로그램이 자원에 직접 접근하는 게 안전할까? 대답은 No다. 따라서 운영체제는 응용 프로그램이 자원에 접근하려 할 때, 오직 자신을 통해서만 접근하도록 제한을 두어 자원을 보호한다. 이런 문지기 역할은 **이중모드**를 통해 달성된다. 이중모드는 크게 두 가지로 구분한다.

1. **사용자 모드**: 운영체제 서비스를 제공받을 수 없는 실행 모드다. 커널 영역의 코드를 실행할 수 없고, 자원에 접근이 불가능하다.
2. **커널 모드**: 운영체제의 서비스를 제공받을 수 있는 실행 모드로 자원 접근을 비롯한 모든 명령어 실행이 가능한 모드다.

플래그 레지스터 속 슈퍼바이저 플래그를 통해 커널 모드인지, 사용자 모드인지 CPU가 알 수 있다.

> 그럼 언제 커널 모드로 전환되는거지?

**시스템 호출**을 통해서 커널 모드로 전환이 된다. 시스템 호출도 일종의 소프트웨어 인터럽트이다.

#### 운영체제의 핵심 서비스
- **프로세스 관리**: 프로세스는 실행 중인 프로그램을 말하고, 일반적으로 동시에 여러 프로세스를 실행한다. 이런 수많은 프로세스들의 생성/실행/삭제를 일목요연하게 관리하는 역할을 담당한다.
- **자원 접근 및 할당**: 어떤 프로세스를 먼저, 얼마나 오래 실행한지를 결정하는 *CPU 스케줄링*과 *페이징*, *스와핑* 같은 메모리 관련 기능을 수행한다.
- **파일 시스템 관리**: 관련된 정보를 *파일*이라는 단위로 묶어 저장 장치에 보관하고, 그 파일들을 묶어 *폴더(디렉토리)* 단위로 저장 장치에 보관하는 역할을 한다.